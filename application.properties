private boolean isAuthorized(String role, String path, String method) {
		switch (role.toUpperCase()) {
		case "ADMIN":
			return path.startsWith("/books") || path.startsWith("/members") || path.startsWith("/borrowings")
					|| path.startsWith("/fines") || path.startsWith("/notifications");

		case "MEMBER":
		    // Allow GET everywhere + POST on /borrowings/return
		    if (method.equalsIgnoreCase("GET")) {
		        return path.startsWith("/members")
		            || path.startsWith("/books")
		            || path.startsWith("/borrowings")
		            || path.startsWith("/fines")
		            || path.startsWith("/notifications");
		    } else if (method.equalsIgnoreCase("POST") || method.equalsIgnoreCase("PUT")) {
		        // Allow returning a book
		        return path.startsWith("/borrowings/return");
		    }
		    return false;
		}
	}
