<app-navbar></app-navbar>

<div class="container" style="margin-top: 130px; max-width: 600px;">
  <div class="card shadow-lg p-4">
    <h3 class="mb-4 text-success text-center">Pay Fine</h3>

    <form (ngSubmit)="payFine()">
      <div class="mb-3">
        <label class="form-label">Member ID</label>
        <input type="number" class="form-control" [(ngModel)]="memberId" name="memberId" placeholder="Enter Member ID" required />
      </div>

      <div class="mb-3">
        <label class="form-label">Fine ID</label>
        <input type="number" class="form-control" [(ngModel)]="fineId" name="fineId" placeholder="Enter Fine ID" required />
      </div>

      <div class="d-grid">
        <button class="btn btn-success" type="submit">Pay Fine</button>
      </div>
    </form>

    <div *ngIf="message" class="alert alert-info mt-4 text-center">
      {{ message }}
    </div>
  </div>
</div>

<app-navbar></app-navbar>

<div class="container" style="margin-top: 130px; max-width: 700px;">
  <div class="card shadow-lg p-4">
    <h3 class="mb-4 text-primary text-center">Calculate Fine</h3>

    <form (ngSubmit)="calculateFine()">
      <div class="mb-3">
        <label for="memberId" class="form-label">Enter Member ID</label>
        <input type="number" class="form-control" [(ngModel)]="memberId" name="memberId" id="memberId" placeholder="e.g. 3" required />
      </div>

      <div class="d-grid">
        <button class="btn btn-primary mb-2" type="submit">Calculate</button>
      </div>
    </form>

    <div *ngIf="message" class="alert alert-success mt-2 text-center">{{ message }}</div>
    <div *ngIf="error" class="alert alert-danger mt-2 text-center">{{ error }}</div>

    <div *ngIf="fineDetails" class="card mt-4 p-4 bg-light border border-primary rounded-3">
      <h5 class="mb-3 text-primary">Fine Details</h5>
      <ul class="list-group list-group-flush">
        <li class="list-group-item"><strong>Fine ID:</strong> {{ fineDetails.fineId }}</li>
        <li class="list-group-item"><strong>Status:</strong> {{ fineDetails.status }}</li>
        <li class="list-group-item"><strong>Amount:</strong> ₹{{ fineDetails.amount }}</li>
        <li class="list-group-item"><strong>Transaction Date:</strong> {{ fineDetails.transactionDate }}</li>
      </ul>

      <h6 class="mt-4 text-secondary">Member Details</h6>
      <ul class="list-group list-group-flush">
        <li class="list-group-item"><strong>Name:</strong> {{ fineDetails.memberId.name }}</li>
        <li class="list-group-item"><strong>Email:</strong> {{ fineDetails.memberId.email }}</li>
        <li class="list-group-item"><strong>Phone:</strong> {{ fineDetails.memberId.phone }}</li>
        <li class="list-group-item"><strong>Address:</strong> {{ fineDetails.memberId.address }}</li>
        <li class="list-group-item"><strong>Status:</strong> {{ fineDetails.memberId.membershipStatus }}</li>
      </ul>
    </div>
  </div>
</div>

import { Component } from '@angular/core';
import { FinesService } from '../fines.service';

@Component({
  selector: 'app-fine-pay',
  templateUrl: './fine-pay.component.html',
  styleUrl: './fine-pay.component.css',
})
export class FinePayComponent {
  memberId!: number;
  fineId!: number;
  message: string = '';
  isLoading: boolean = false;

  constructor(private fineService: FinesService) {}

  payFine(): void {
    this.message = '';
    this.isLoading = true;

    if (!this.memberId || !this.fineId || this.memberId <= 0 || this.fineId <= 0) {
      this.message = 'Please enter valid Member ID and Fine ID.';
      this.isLoading = false;
      return;
    }

    console.log(`Paying fine ${this.fineId} for member ${this.memberId}`);

    this.fineService.payFine(this.memberId, this.fineId).subscribe({
      next: () => {
        this.message = `✅ Fine with ID ${this.fineId} paid successfully by member ${this.memberId}.`;
        console.log(this.message);
        this.isLoading = false;
      },
      error: (err) => {
        this.message = '❌ Error paying fine. Please check the Member ID and Fine ID.';
        console.error('Payment Error:', err);
        this.isLoading = false;
      }
    });
  }
}

import { Component } from '@angular/core';
import { FinesService } from '../fines.service';

@Component({
  selector: 'app-fine-cal',
  templateUrl: './fine-cal.component.html',
  styleUrl: './fine-cal.component.css',
})
export class FineCalComponent {
  memberId!: number;
  fineDetails: any = null;
  message: string = '';
  error: string = '';
  isLoading: boolean = false;

  constructor(private finesService: FinesService) {}

  calculateFine(): void {
    this.message = '';
    this.error = '';
    this.fineDetails = null;
    this.isLoading = true;

    if (!this.memberId || this.memberId <= 0) {
      this.error = '⚠️ Please enter a valid Member ID.';
      this.isLoading = false;
      return;
    }

    console.log(`Calculating fine for member ID ${this.memberId}`);

    this.finesService.calculateFine(this.memberId).subscribe({
      next: (res) => {
        this.fineDetails = res;
        this.message = '✅ Fine calculated successfully.';
        console.log('Fine Details:', res);
        this.isLoading = false;
      },
      error: (err) => {
        this.error = '❌ Failed to calculate fine. Please check the Member ID.';
        console.error('Calculation Error:', err);
        this.isLoading = false;
      }
    });
  }
}


<div *ngIf="isLoading" class="text-center mt-3">
  <div class="spinner-border text-primary" role="status">
    <span class="visually-hidden">Loading...</span>
  </div>
</div>
