import { Component, OnInit } from '@angular/core';
import { Route, Router, RouterLink } from '@angular/router';
import { CommonService } from '../common.service';
import { LoginComponent } from '../login/login.component';
import { AuthService } from '../auth.service';
import { jwtDecode } from 'jwt-decode';

@Component({
  selector: 'app-navbar',
  imports: [RouterLink],
  templateUrl: './navbar.component.html',
  styleUrl: './navbar.component.css'
})
export class NavbarComponent {
isLoggedIn=true
userRole: string = '';

constructor(private router:Router,private commonService:CommonService,private authService:AuthService){

  if(authService.getJWT())
 {
this.isLoggedIn=false
 }
}
 extractRole(): void {
    const token = localStorage.getItem('JWT');
    if (token) {
      try {
        const decoded: any = jwtDecode(token);
        this.userRole = decoded.role || decoded.roles || '';
        localStorage.setItem("userId", decoded.userId);
      } catch (err) {
        console.error('Failed to decode JWT', err);
      }
    }
  }

logout()
 {
  this.authService.removeToken();
  this.isLoggedIn=true
  alert("logged out successfully")
  this.router.navigate(["/home"])
 }

}


  <nav class="navbar navbar-expand-sm navbar-scroll fixed-top">
    <div class="container-fluid">
      
      <a class="navbar-brand text-white fw-bold d-flex align-items-center" routerLink="/home">
        <i class="fas fa-home me-2"></i>
        <span class="d-none d-md-inline">Library</span>
      </a>
      <ul class="navbar-nav ms-auto mb-2 mb-lg-0">

        
        <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarNav"
        aria-controls="navbarNav" aria-expanded="false" aria-label="Toggle navigation">
        <span class="navbar-toggler-icon text-white"></span>
      </button>
        @if(isLoggedIn){
          <li class="nav-item">
            <a class="nav-link" routerLink="/login">LOGIN</a>
          </li>}
        @if(isLoggedIn){
          <li class="nav-item">
            <a class="nav-link" routerLink="/register">REGISTER</a>
          </li>}
        @if(!isLoggedIn){
        <li class="nav-item">
          <a class="nav-link" routerLink="/allBook">BOOK</a>
        </li>}
        @if(!isLoggedIn){
        <li class="nav-item">
          <a class="nav-link" routerLink="/memberUpDel">MEMBERS</a>
        </li>}

        <!-- @if(!isLoggedIn){
        <li class="nav-item">
          <a class="nav-link" routerLink="/borrow">BORROW'S</a>
        </li>}  -->
         <!-- @if(!isLoggedIn){
        <li class="nav-item">
          <a class="nav-link" routerLink="/fine">FINE'S</a>
        </li>}  -->
         <!-- @if(!isLoggedIn ){
        <li class="nav-item">
          <a class="nav-link" routerLink="/notification">NOTIFICATION</a>
        </li>} -->
        @if(!isLoggedIn){
        <li class="nav-item">
          <a class="nav-link" (click)="logout()">LOGOUT</a>
        </li>}
      </ul>
    </div>
  </nav>
  
   
