private boolean isAuthorized(String role, String path, String method) {
	    switch (role.toUpperCase()) {
	        case "ADMIN":
	            return path.startsWith("/books")
	                || path.startsWith("/members")
	                || path.startsWith("/borrowings")
	                || path.startsWith("/fines")
	                || path.startsWith("/notifications");

	        case "MEMBER":
	            // Allow GET requests to these paths
	            if (method.equalsIgnoreCase("GET")) {
	                return path.startsWith("/members")
	                    || path.startsWith("/books")
	                    || path.startsWith("/borrowings")
	                    || path.startsWith("/fines")
	                    || path.startsWith("/notifications");
	            }
	            // Allow POST/PUT only for borrow and return operations
	            else if (method.equalsIgnoreCase("POST") || method.equalsIgnoreCase("PUT")) {
	                return path.startsWith("/borrowings/return")
	                    || path.startsWith("/borrowings/borrow");
	            }
	            return false;

	        default:
	            return false;
	    }
	}
